{{>header}}
{{>options}}

<div class="tc w-100 pt5 mt2">
  <span class="dark-text">{{localText.formInfo}}</span>
</div>

<div class="tc w-100 mt2">
  <span class="red" id="EventErrorBox"></span>
</div>

{{#if edit}}
  <form id="EditEventForm" action="/{{lang}}/edit-event/{{event._id}}" method="post">
    <input type="hidden" name="_method" value="put">
{{else}}
  <form id="AddEventForm" action="/{{lang}}/add-event" method="post">
    <input type="hidden" name="_method" value="post">
{{/if}}
<table class="f6 w-100 mw8 center bb b--turquoise bw2">
  <tbody>
    <tr>
      <td class="w-20 dark-text f4 b pa3 tr">*{{localText.name}}</td>
      <td class="w-70">
          {{#if event.en.name}}
            <input class="input-reset w-70 br2 ba pa1 b--gray" type="text" name="name_en" value="{{event.en.name}}">
          {{else}}
            <input class="input-reset w-70 br2 ba pa1 b--gray dib" type="text" name="name_en" placeholder="{{localText.english}}">
          {{/if}}
      </td>
    </tr>
    <tr>
        <td class="w-20"></td>
        <td class="w-70">
          {{#if event.ar.name}}
            <input class="input-reset w-70 br2 ba pa1 b--gray" type="text" name="name_ar" value="{{event.ar.name}}">
          {{else}}
            <input class="input-reset w-70 br2 ba pa1 b--gray dib" type="text" name="name_ar" placeholder="{{localText.arabic}}">
          {{/if}}
        </td>
    </tr>
    <tr>
      <td class="w-20 dark-text f4 b pa3 tr">{{localText.description}}</td>
      <td class="w-70 pt3">
          {{#if event.en.description}}
            <textarea class="input-reset w-70 br2 ba pa1 b--gray" type="text" name="description_en">{{event.en.description}}</textarea>
          {{else}}
            <textarea class="input-reset w-70 br2 ba pa1 b--gray dib" type="text" name="description_en" placeholder="{{localText.english}}"></textarea>
          {{/if}}
      </td>
    </tr>
    <tr>
        <td class="w-20"></td>
        <td class="w-70">
          {{#if event.ar.description}}
            <textarea class="input-reset w-70 br2 ba pa1 b--gray" type="text" name="description_ar">{{event.ar.description}}</textarea>
          {{else}}
            <textarea class="input-reset w-70 br2 ba pa1 b--gray dib" type="text" name="description_ar" placeholder="{{localText.arabic}}"></textarea>
          {{/if}}
        </td>
    </tr>
    <tr>
        <td class="w-20 dark-text f4 b pa3 tr">{{localText.eventsPlace}}</td>
        <td class="w-70">
          <select class="w-70 pa1" name="eventPlace">
            <option value="">{{localText.selectPlace}}</option>
            {{#each placesNamesAndIds}}
              <option value="{{this.id}}" {{checkedDropDown ../event.place._id this.id}}>{{this.name}}</option>
            {{/each}}
          </select>
        </td>
    </tr>
    <tr>
      <td class="w-20 dark-text f4 b pb3 ph3 pt1 tr">{{localText.eventStart}}</td>
      <td class="w-70">
          {{#if event.startTime}}
            <input class="w-50 br2 ba pa1 b--gray" type="date" name="startTime" value="{{getDate event.startTime}}" required>
            <select class="w-10 br2 ba pa1 b--gray bg-white dib" name="startHour" required>
                <option value="{{getHours event.startTime}}">{{getHours event.startTime}}</option>
                {{#iterate 23}}
                  <option value="{{this}}">{{this}}</option>
                {{/iterate}}
            </select>
            <select class="w-10 br2 ba pa1 b--gray bg-white dib" name="startMinutes" required>
                <option value="{{getMinutes event.startTime}}">{{getMinutes event.startTime}}</option>
                {{#iterate 59}}
                  <option value="{{this}}">{{this}}</option>
                {{/iterate}}
            </select>
          {{else}}
            <input class="input-reset w-50 br2 ba pa1 b--gray dib" type="date" name="startTime" required>
            <select class="w-10 br2 ba pa1 b--gray bg-white dib" name="startHour" required>
                <option value="">Hour</option>
                {{#iterate 23}}
                  <option value="{{this}}">{{this}}</option>
                {{/iterate}}
            </select>
            <select class="w-10 br2 ba pa1 b--gray bg-white dib" name="startMinutes" required>
                <option value="">Minute</option>
                {{#iterate 59}}
                  <option value="{{this}}">{{this}}</option>
                {{/iterate}}
            </select>

          {{/if}}
      </td>
    </tr>
    <tr>
      <td class="w-20 dark-text f4 b ph3 pb3 pt0 tr">{{localText.eventEnd}}</td>
      <td class="w-70">
          {{#if event.endTime}}
            <input class="input-reset w-50 br2 ba pa1 b--gray" type="date" name="endTime" value="{{getDate event.endTime}}" required>
            <select class="w-10 br2 ba pa1 b--gray bg-white dib" name="endHour" required>
                <option value="{{getHours event.endTime}}">{{getHours event.endTime}}</option>
                {{#iterate 23}}
                  <option value="{{this}}">{{this}}</option>
                {{/iterate}}
            </select>
            <select class="w-10 br2 ba pa1 b--gray bg-white dib" name="endMinutes" required>
                <option value="{{getMinutes event.endTime}}">{{getMinutes event.endTime}}</option>
                {{#iterate 59}}
                  <option value="{{this}}">{{this}}</option>
                {{/iterate}}
            </select>
          {{else}}
            <input class="input-reset w-50 br2 ba pa1 b--gray dib" type="date" name="endTime" required>
            <select class="w-10 br2 ba pa1 b--gray bg-white dib" name="endHour" required>
                <option value="">Hour</option>
                {{#iterate 23}}
                  <option value="{{this}}">{{this}}</option>
                {{/iterate}}
            </select>
            <select class="w-10 br2 ba pa1 b--gray bg-white dib" name="endMinutes" required>
                <option value="">Minute</option>
                {{#iterate 59}}
                  <option value="{{this}}">{{this}}</option>
                {{/iterate}}
            </select>
          {{/if}}
      </td>
    </tr>
    <tr>
      <td class="w-20 dark-text f4 b ph3 pb2 pt0 tr">{{localText.eventsCost}}</td>
      <td class="w-70">
          {{#if event.cost}}
            <input class="input-reset w-70 br2 ba pa1 b--gray" type="text" name="cost" value="{{event.cost}}">
          {{else}}
            <input class="input-reset w-70 br2 ba pa1 b--gray dib" type="text" name="cost">
          {{/if}}
      </td>
    </tr>
    <tr>
      <td class="w-20 dark-text f4 b ph3 pb2 pt0 tr">{{localText.formImageUrl}}</td>
      <td class="w-70">
          {{#if event.imageUrl}}
            <input class="input-reset w-70 br2 ba pa1 b--gray" type="text" name="imageUrl" value="{{event.imageUrl}}" placeholder="{{localText.formImageUrl}}">
          {{else}}
            <input class="input-reset w-70 br2 ba pa1 b--gray dib" type="text" name="imageUrl" placeholder="{{localText.formImageUrl}}">
          {{/if}}
      </td>
    </tr>
    <tr>
      <td class="tr pb3 pl4 pt0"></td>
      <td class="">
        <span class="b dark-text">OR</span>
      </td>
    </tr>
    <tr>
      <td class="w-20 dark-text f4 b ph3 pb3 pt0 tr">{{localText.formImage}}</td>
      <td class="w-70">
          <input type="hidden" id="hiddenFileInput" name="s3Url">
          <div class="flex">
            <input type="file" class="input-reset w-60 br2 ba pa1 b--gray dib" accept="image/jpeg,image/x-png" id="eventFileInput">
            <div id="spinner" class="dn mh2"></div>
          </div>
          <img src="" id="imagePreview" class="w-10 h-10 dn pa1" alt="Your uploaded image">
          <span id="fileErrorMessage" class="dib red"></span>
      </td>
    </tr>
    <tr>
      <td class="w-20 dark-text f4 b pa3 tr">{{localText.accessibilityOptions}}
      </td>
      <td><table><tr>

          {{#each localText.accOptions}}
            <td class="flex items-center mb2">
              <input
              class="mr2"
              id="{{getKey this ../lang}}"
              type="checkbox"
              name="accessibility"
              value="{{this.en}}" {{checkOptionsValue ../event.accessibilityOptions getKey this ../lang}}>
              <label  for="{{getKey this ../lang}}" class="light-text">{{getKey this ../lang}}</label>
            </td>
          {{/each}}

        <td class="dark-text f4 b pa3">*{{localText.categories}}</td>

          {{#each localText.eventCategories}}
            <td class="flex items-center mb2">
              <input class="mr2" id="{{getKey this ../lang}}" type="checkbox" name="categories" value="{{this.en}}" {{checkOptionsValue ../event.categories (getKey this ../lang)}}>
              <label for="{{getKey this ../lang}}" class="light-text">{{toUpperCase (getKey this ../lang)}}</label>
            </td>
          {{/each}}

      </tr></table></td>
    </tr>
  </tbody>
</table>
<div class="w-100 tc pa4">

  <input class="f6 w4 tc grow br-pill ba bw1 b--gray pv2 dib mid-gray b bg-main outline-0" type="submit" value="{{localText.formSubmit}}">
</div>
</form>

<script src="/validate-event-form.js" charset="utf-8"></script>
<script src="/image-upload.js" charset="utf-8"></script>
